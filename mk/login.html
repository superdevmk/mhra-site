<!DOCTYPE html>
<html lang="mk">
  <head>
    <meta charset="UTF-8" />
    <title>Најава | МАЧР</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="stylesheet" href="../assets/css/style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
  </head>

  <body>
    <!-- HEADER (ист како на останатите страници) -->
    <header class="header">
      <div class="nav-wrapper">
        <div class="nav">
          <a href="index.html" class="nav__brand">
            <img
              src="../assets/img/mhra_logo.jpg"
              alt="MHRA Logo"
              class="nav__logo-img"
            />
          </a>

          <nav class="nav__menu">
            <div class="nav__links">
              <a class="nav__link" href="index.html" data-i18n="nav_home">Почетна</a>
              <a class="nav__link" href="about.html" data-i18n="nav_about">За нас</a>
              <a class="nav__link" href="activities.html" data-i18n="nav_activities">Активности</a>
              <a class="nav__link" href="galleries.html" data-i18n="nav_galleries">Галерии</a>
              <a class="nav__link" href="events.html" data-i18n="nav_events">HR настани</a>
              <a class="nav__link" href="blog.html" data-i18n="nav_blog">Блог</a>
              <a class="nav__link" href="membership.html" data-i18n="nav_membership">Членство</a>
              <a class="nav__link" href="contact.html" data-i18n="nav_contact">Контакт</a>
            </div>

            <div class="nav__lang">
              <button data-lang="mk" class="nav__lang-btn">MK</button> |
              <button data-lang="en" class="nav__lang-btn">EN</button>
            </div>

            <div class="nav__cta">
              <a href="membership.html" class="btn btn--primary" data-i18n="nav_cta_join"></a>
            </div>
          </nav>

          <button class="nav__toggle" aria-label="menu">
            <span class="nav__toggle-bar"></span>
          </button>
        </div>
      </div>
    </header>

    <main>
      <section class="section section--center">
        <div class="section-shell">
          <div class="section__header">
            <h1 class="section__title">Најава / Регистрација за автори</h1>
            <p class="section__subtitle">
              Креирај сметка или најави се за да објавуваш блог текстови.
            </p>
          </div>

          <div class="card" style="max-width: 480px; margin: 0 auto;">
            <form id="login-form" class="auth-form">
              <div class="form-group">
                <label class="form__label" for="email">Е-пошта</label>
                <input
                  id="email"
                  class="input"
                  type="email"
                  placeholder="you@example.com"
                  required
                />
              </div>

              <div class="form-group" style="margin-top:.75rem;">
                <label class="form__label" for="password">Лозинка</label>
                <input
                  id="password"
                  class="input"
                  type="password"
                  placeholder="••••••••"
                  required
                />
              </div>

              <p id="auth-status" class="section__subtitle" style="margin-top:.75rem;"></p>

              <div
                style="display:flex; gap:.5rem; margin-top: 1rem; flex-wrap: wrap;"
              >
                <button
                  type="submit"
                  id="login-submit"
                  class="btn btn--primary"
                >
                  Најава
                </button>

                <button
                  type="button"
                  id="signup-btn"
                  class="btn btn--outline"
                >
                  Регистрација
                </button>
              </div>
            </form>
          </div>

          <p class="section__subtitle" style="margin-top:1rem; text-align:center;">
            По успешна најава, ќе бидете пренасочени кон блогот.
          </p>
        </div>
      </section>
    </main>

    <!-- FOOTER -->
    <footer class="footer">
      <div class="footer__inner">
        <div class="footer__top">
          <div>
            <div class="footer__brand" data-i18n="footer_brand"></div>
            <p data-i18n="footer_desc"></p>
          </div>
          <div>
            <p><strong data-i18n="footer_contact"></strong></p>
            <p>
              Адреса: Македонска асоцијација за човечки ресурси<br />
              Бул. ВМРО бр. 7/1-7<br />
              1000 Скопје, Македонија
            </p>
            <p>Email: contact@mhra.mk</p>
          </div>
          <div>
            <p><strong data-i18n="footer_links_title"></strong></p>
            <div class="footer__links">
              <a href="index.html" data-i18n="footer_link_home"></a>
              <a href="membership.html" data-i18n="footer_link_membership"></a>
              <a href="contact.html" data-i18n="footer_link_contact"></a>
              <a href="#" data-i18n="footer_link_privacy"></a>
              <a href="#" data-i18n="footer_link_terms"></a>
            </div>
          </div>
        </div>

        <div class="footer__bottom">
          © <span id="year-login-mk"></span> MHRA ·
          <span data-i18n="footer_rights"></span>
        </div>
      </div>
    </footer>

    <script>
      document.getElementById("year-login-mk").textContent =
        new Date().getFullYear();
    </script>

    <!-- Skriptet globale -->
    <script src="../assets/js/main.js"></script>
    <script src="../assets/js/i18n.js"></script>

    <!-- Supabase (CDN + клиент) -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../assets/js/supabaseClient.js"></script>
    <script src="../assets/js/auth.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const form = document.getElementById("login-form");
        const submitBtn = document.getElementById("login-submit");
        const signupBtn = document.getElementById("signup-btn");
        const statusEl = document.getElementById("auth-status");

        function setStatus(msg, isError = false) {
          statusEl.textContent = msg || "";
          statusEl.style.color = isError ? "crimson" : "";
        }

        // Најава
        form.addEventListener("submit", async (e) => {
          e.preventDefault();

          const email = document.getElementById("email").value.trim();
          const password = document.getElementById("password").value.trim();

          if (!email || !password) {
            setStatus("Внесете е-пошта и лозинка.", true);
            return;
          }

          submitBtn.disabled = true;
          const oldText = submitBtn.textContent;
          submitBtn.textContent = "Се врши најава...";

          try {
            await signIn(email, password);
            setStatus("Успешна најава. Пренасочување кон блогот...", false);
            window.location.href = "blog.html";
          } catch (err) {
            console.error(err);
            setStatus(err.message || "Настана грешка при најава.", true);
          } finally {
            submitBtn.disabled = false;
            submitBtn.textContent = oldText;
          }
        });

        // Регистрација (signup)
        signupBtn.addEventListener("click", async () => {
          const email = document.getElementById("email").value.trim();
          const password = document.getElementById("password").value.trim();

          if (!email || !password) {
            setStatus("Внесете е-пошта и лозинка.", true);
            return;
          }

          setStatus("Се креира сметка...", false);

          try {
            await signUp(email, password);
            setStatus(
              "Сметката е креирана. Доколку е потребно, проверете ја е-поштата за потврда.",
              false
            );
          } catch (err) {
            console.error(err);
            setStatus(err.message || "Настана грешка при регистрација.", true);
          }
        });
      });
    </script>
  </body>
</html>
